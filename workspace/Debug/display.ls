   1                     ; C Compiler for STM8 (COSMIC Software)
   2                     ; Generator V4.2.8 - 03 Dec 2008
   4                     .const:	section	.text
   5  0000               _LCD_NUM_BIT:
   6  0000 0e            	dc.b	14
   7  0001 2a            	dc.b	42
   8  0002 46            	dc.b	70
   9  0003 62            	dc.b	98
  10  0004 45            	dc.b	69
  11  0005 0d            	dc.b	13
  12  0006 29            	dc.b	41
  13  0007 00            	ds.b	1
  14  0008 10            	dc.b	16
  15  0009 2c            	dc.b	44
  16  000a 48            	dc.b	72
  17  000b 64            	dc.b	100
  18  000c 47            	dc.b	71
  19  000d 0f            	dc.b	15
  20  000e 2b            	dc.b	43
  21  000f 00            	ds.b	1
  22  0010 14            	dc.b	20
  23  0011 30            	dc.b	48
  24  0012 4c            	dc.b	76
  25  0013 68            	dc.b	104
  26  0014 4b            	dc.b	75
  27  0015 13            	dc.b	19
  28  0016 2f            	dc.b	47
  29  0017 00            	dc.b	0
  30  0018 75            	dc.b	117
  31  0019 85            	dc.b	133
  32  001a 95            	dc.b	149
  33  001b a5            	dc.b	165
  34  001c 94            	dc.b	148
  35  001d 74            	dc.b	116
  36  001e 84            	dc.b	132
  37  001f 00            	ds.b	1
  38  0020 77            	dc.b	119
  39  0021 87            	dc.b	135
  40  0022 97            	dc.b	151
  41  0023 a7            	dc.b	167
  42  0024 96            	dc.b	150
  43  0025 76            	dc.b	118
  44  0026 86            	dc.b	134
  45  0027 00            	ds.b	1
  46  0028 18            	dc.b	24
  47  0029 34            	dc.b	52
  48  002a 50            	dc.b	80
  49  002b 6c            	dc.b	108
  50  002c 4f            	dc.b	79
  51  002d 17            	dc.b	23
  52  002e 33            	dc.b	51
  53  002f 00            	ds.b	1
  54  0030 5f            	dc.b	95
  55  0031 43            	dc.b	67
  56  0032 27            	dc.b	39
  57  0033 0c            	dc.b	12
  58  0034 28            	dc.b	40
  59  0035 60            	dc.b	96
  60  0036 44            	dc.b	68
  61  0037 00            	ds.b	1
  62  0038 5b            	dc.b	91
  63  0039 3f            	dc.b	63
  64  003a 23            	dc.b	35
  65  003b 0a            	dc.b	10
  66  003c 26            	dc.b	38
  67  003d 5e            	dc.b	94
  68  003e 42            	dc.b	66
  69  003f 00            	ds.b	1
  70  0040 59            	dc.b	89
  71  0041 3d            	dc.b	61
  72  0042 21            	dc.b	33
  73  0043 06            	dc.b	6
  74  0044 22            	dc.b	34
  75  0045 5a            	dc.b	90
  76  0046 3e            	dc.b	62
  77  0047 00            	ds.b	1
  78  0048 1b            	dc.b	27
  79  0049 67            	dc.b	103
  80  004a 01            	dc.b	1
  81  004b 00            	dc.b	0
  82  004c 15            	dc.b	21
  83  004d 00            	dc.b	0
  84  004e 00            	dc.b	0
  85  004f 00            	ds.b	1
  86  0050 55            	dc.b	85
  87  0051 39            	dc.b	57
  88  0052 1d            	dc.b	29
  89  0053 73            	dc.b	115
  90  0054 83            	dc.b	131
  91  0055 a3            	dc.b	163
  92  0056 93            	dc.b	147
  93  0057 00            	ds.b	1
  94  0058 57            	dc.b	87
  95  0059 3b            	dc.b	59
  96  005a 1f            	dc.b	31
  97  005b 02            	dc.b	2
  98  005c 1e            	dc.b	30
  99  005d 56            	dc.b	86
 100  005e 3a            	dc.b	58
 101  005f 00            	ds.b	1
 102  0060               _LCD_CHAR_BIT:
 103  0060 63            	dc.b	99
 104  0061 a6            	dc.b	166
 105  0062 69            	dc.b	105
 106  0063 31            	dc.b	49
 107  0064 4d            	dc.b	77
 108  0065 6b            	dc.b	107
 109  0066 0b            	dc.b	11
 110  0067 07            	dc.b	7
 111  0068 61            	dc.b	97
 112  0069 a4            	dc.b	164
 113  006a 05            	dc.b	5
 114  006b 04            	dc.b	4
 115  006c 58            	dc.b	88
 116  006d 3c            	dc.b	60
 117  006e 20            	dc.b	32
 118  006f 03            	dc.b	3
 119  0070               _SEG8:
 120  0070 fc            	dc.b	252
 121  0071 60            	dc.b	96
 122  0072 da            	dc.b	218
 123  0073 f2            	dc.b	242
 124  0074 66            	dc.b	102
 125  0075 b6            	dc.b	182
 126  0076 be            	dc.b	190
 127  0077 e0            	dc.b	224
 128  0078 fe            	dc.b	254
 129  0079 f6            	dc.b	246
 130  007a ee            	dc.b	238
 131  007b 3e            	dc.b	62
 132  007c 9c            	dc.b	156
 133  007d 7a            	dc.b	122
 134  007e 9e            	dc.b	158
 135  007f 8e            	dc.b	142
 136  0080 00            	dc.b	0
 223                     ; 68 static void display_num(uint8_t pos, uint8_t val)
 223                     ; 69 {
 225                     	switch	.text
 226  0000               L3_display_num:
 228  0000 89            	pushw	x
 229  0001 5204          	subw	sp,#4
 230       00000004      OFST:	set	4
 233                     ; 72     i = SEG8[val];
 235  0003 9f            	ld	a,xl
 236  0004 5f            	clrw	x
 237  0005 97            	ld	xl,a
 238  0006 d60070        	ld	a,(_SEG8,x)
 239  0009 6b01          	ld	(OFST-3,sp),a
 240                     ; 73     for (j=0; j<8; j++)
 242  000b 0f02          	clr	(OFST-2,sp)
 243  000d               L55:
 244                     ; 75         k = LCD_NUM_BIT[pos][j];
 246  000d 7b05          	ld	a,(OFST+1,sp)
 247  000f 97            	ld	xl,a
 248  0010 a608          	ld	a,#8
 249  0012 42            	mul	x,a
 250  0013 01            	rrwa	x,a
 251  0014 1b02          	add	a,(OFST-2,sp)
 252  0016 2401          	jrnc	L6
 253  0018 5c            	incw	x
 254  0019               L6:
 255  0019 02            	rlwa	x,a
 256  001a d60000        	ld	a,(_LCD_NUM_BIT,x)
 257  001d 6b04          	ld	(OFST+0,sp),a
 258                     ; 76         L = k & 0x07;
 260  001f 7b04          	ld	a,(OFST+0,sp)
 261  0021 a407          	and	a,#7
 262  0023 6b03          	ld	(OFST-1,sp),a
 263                     ; 77         L = 1 << L;
 265  0025 7b03          	ld	a,(OFST-1,sp)
 266  0027 5f            	clrw	x
 267  0028 97            	ld	xl,a
 268  0029 a601          	ld	a,#1
 269  002b 5d            	tnzw	x
 270  002c 2704          	jreq	L01
 271  002e               L21:
 272  002e 48            	sll	a
 273  002f 5a            	decw	x
 274  0030 26fc          	jrne	L21
 275  0032               L01:
 276  0032 6b03          	ld	(OFST-1,sp),a
 277                     ; 78         k = k >> 3;
 279  0034 0404          	srl	(OFST+0,sp)
 280  0036 0404          	srl	(OFST+0,sp)
 281  0038 0404          	srl	(OFST+0,sp)
 282                     ; 79         if (i & 0x80)
 284  003a 7b01          	ld	a,(OFST-3,sp)
 285  003c a580          	bcp	a,#128
 286  003e 270e          	jreq	L36
 287                     ; 80             LCD->RAM[k] |= L;
 289  0040 7b04          	ld	a,(OFST+0,sp)
 290  0042 5f            	clrw	x
 291  0043 97            	ld	xl,a
 292  0044 d6540c        	ld	a,(21516,x)
 293  0047 1a03          	or	a,(OFST-1,sp)
 294  0049 d7540c        	ld	(21516,x),a
 296  004c 200d          	jra	L56
 297  004e               L36:
 298                     ; 82             LCD->RAM[k] &= ~L;
 300  004e 7b04          	ld	a,(OFST+0,sp)
 301  0050 5f            	clrw	x
 302  0051 97            	ld	xl,a
 303  0052 7b03          	ld	a,(OFST-1,sp)
 304  0054 43            	cpl	a
 305  0055 d4540c        	and	a,(21516,x)
 306  0058 d7540c        	ld	(21516,x),a
 307  005b               L56:
 308                     ; 83         i = i << 1;
 310  005b 0801          	sll	(OFST-3,sp)
 311                     ; 73     for (j=0; j<8; j++)
 313  005d 0c02          	inc	(OFST-2,sp)
 316  005f 7b02          	ld	a,(OFST-2,sp)
 317  0061 a108          	cp	a,#8
 318  0063 25a8          	jrult	L55
 319                     ; 85 }
 322  0065 5b06          	addw	sp,#6
 323  0067 81            	ret
 532                     ; 87 static void display_char(enum display_type type, bool on)
 532                     ; 88 {
 533                     	switch	.text
 534  0068               L76_display_char:
 536  0068 89            	pushw	x
 537  0069 89            	pushw	x
 538       00000002      OFST:	set	2
 541                     ; 91     k = LCD_CHAR_BIT[type];
 543  006a 9e            	ld	a,xh
 544  006b 5f            	clrw	x
 545  006c 97            	ld	xl,a
 546  006d d60060        	ld	a,(_LCD_CHAR_BIT,x)
 547  0070 6b02          	ld	(OFST+0,sp),a
 548                     ; 92     L = k & 0x7;
 550  0072 7b02          	ld	a,(OFST+0,sp)
 551  0074 a407          	and	a,#7
 552  0076 6b01          	ld	(OFST-1,sp),a
 553                     ; 93     L = 1 << L;
 555  0078 7b01          	ld	a,(OFST-1,sp)
 556  007a 5f            	clrw	x
 557  007b 97            	ld	xl,a
 558  007c a601          	ld	a,#1
 559  007e 5d            	tnzw	x
 560  007f 2704          	jreq	L61
 561  0081               L02:
 562  0081 48            	sll	a
 563  0082 5a            	decw	x
 564  0083 26fc          	jrne	L02
 565  0085               L61:
 566  0085 6b01          	ld	(OFST-1,sp),a
 567                     ; 94     k = k >> 3;
 569  0087 0402          	srl	(OFST+0,sp)
 570  0089 0402          	srl	(OFST+0,sp)
 571  008b 0402          	srl	(OFST+0,sp)
 572                     ; 96     if (on)
 574  008d 0d04          	tnz	(OFST+2,sp)
 575  008f 270e          	jreq	L102
 576                     ; 97         LCD->RAM[k] |= L;
 578  0091 7b02          	ld	a,(OFST+0,sp)
 579  0093 5f            	clrw	x
 580  0094 97            	ld	xl,a
 581  0095 d6540c        	ld	a,(21516,x)
 582  0098 1a01          	or	a,(OFST-1,sp)
 583  009a d7540c        	ld	(21516,x),a
 585  009d 200d          	jra	L302
 586  009f               L102:
 587                     ; 99         LCD->RAM[k] &= ~L;
 589  009f 7b02          	ld	a,(OFST+0,sp)
 590  00a1 5f            	clrw	x
 591  00a2 97            	ld	xl,a
 592  00a3 7b01          	ld	a,(OFST-1,sp)
 593  00a5 43            	cpl	a
 594  00a6 d4540c        	and	a,(21516,x)
 595  00a9 d7540c        	ld	(21516,x),a
 596  00ac               L302:
 597                     ; 100 }
 600  00ac 5b04          	addw	sp,#4
 601  00ae 81            	ret
 674                     ; 102 static void display_time(uint8_t type, uint8_t num1, uint8_t num2, bool on)
 674                     ; 103 {
 675                     	switch	.text
 676  00af               L502_display_time:
 678  00af 89            	pushw	x
 679  00b0 88            	push	a
 680       00000001      OFST:	set	1
 683                     ; 104     uint8_t base = (type == Date) ? 0 : 3;
 685  00b1 9e            	ld	a,xh
 686  00b2 4d            	tnz	a
 687  00b3 2603          	jrne	L42
 688  00b5 4f            	clr	a
 689  00b6 2002          	jra	L62
 690  00b8               L42:
 691  00b8 a603          	ld	a,#3
 692  00ba               L62:
 693  00ba 6b01          	ld	(OFST+0,sp),a
 694                     ; 106     if (!on)
 696  00bc 0d07          	tnz	(OFST+6,sp)
 697  00be 262e          	jrne	L542
 698                     ; 108         display_char((type == Date) ? Ten1 : Ten2, 0);
 700  00c0 9e            	ld	a,xh
 701  00c1 4d            	tnz	a
 702  00c2 2604          	jrne	L03
 703  00c4 a608          	ld	a,#8
 704  00c6 2002          	jra	L23
 705  00c8               L03:
 706  00c8 a609          	ld	a,#9
 707  00ca               L23:
 708  00ca 5f            	clrw	x
 709  00cb 95            	ld	xh,a
 710  00cc ad9a          	call	L76_display_char
 712                     ; 109         display_num(base, 16);
 714  00ce ae0010        	ldw	x,#16
 715  00d1 7b01          	ld	a,(OFST+0,sp)
 716  00d3 95            	ld	xh,a
 717  00d4 cd0000        	call	L3_display_num
 719                     ; 110         display_num(base + 1, 16);
 721  00d7 ae0010        	ldw	x,#16
 722  00da 7b01          	ld	a,(OFST+0,sp)
 723  00dc 4c            	inc	a
 724  00dd 95            	ld	xh,a
 725  00de cd0000        	call	L3_display_num
 727                     ; 111         display_num(base + 2, 16);
 729  00e1 ae0010        	ldw	x,#16
 730  00e4 7b01          	ld	a,(OFST+0,sp)
 731  00e6 ab02          	add	a,#2
 732  00e8 95            	ld	xh,a
 733  00e9 cd0000        	call	L3_display_num
 735                     ; 112         return;
 737  00ec 205c          	jra	L44
 738  00ee               L542:
 739                     ; 115     display_char((type == Date) ? Ten1 : Ten2, (_Bool)(num1 / 10));
 741  00ee 7b03          	ld	a,(OFST+2,sp)
 742  00f0 5f            	clrw	x
 743  00f1 97            	ld	xl,a
 744  00f2 a60a          	ld	a,#10
 745  00f4 cd0000        	call	c_sdivx
 747  00f7 a30000        	cpw	x,#0
 748  00fa 2704          	jreq	L43
 749  00fc a601          	ld	a,#1
 750  00fe 2001          	jra	L63
 751  0100               L43:
 752  0100 4f            	clr	a
 753  0101               L63:
 754  0101 97            	ld	xl,a
 755  0102 89            	pushw	x
 756  0103 0d04          	tnz	(OFST+3,sp)
 757  0105 2604          	jrne	L04
 758  0107 a608          	ld	a,#8
 759  0109 2002          	jra	L24
 760  010b               L04:
 761  010b a609          	ld	a,#9
 762  010d               L24:
 763  010d 85            	popw	x
 764  010e 95            	ld	xh,a
 765  010f cd0068        	call	L76_display_char
 767                     ; 116     display_num(base, num1 % 10);
 769  0112 7b03          	ld	a,(OFST+2,sp)
 770  0114 ae000a        	ldw	x,#10
 771  0117 51            	exgw	x,y
 772  0118 5f            	clrw	x
 773  0119 97            	ld	xl,a
 774  011a 65            	divw	x,y
 775  011b 909f          	ld	a,yl
 776  011d 97            	ld	xl,a
 777  011e 7b01          	ld	a,(OFST+0,sp)
 778  0120 95            	ld	xh,a
 779  0121 cd0000        	call	L3_display_num
 781                     ; 117     display_num(base + 1, num2 / 10);
 783  0124 7b06          	ld	a,(OFST+5,sp)
 784  0126 ae000a        	ldw	x,#10
 785  0129 51            	exgw	x,y
 786  012a 5f            	clrw	x
 787  012b 97            	ld	xl,a
 788  012c 65            	divw	x,y
 789  012d 9f            	ld	a,xl
 790  012e 97            	ld	xl,a
 791  012f 7b01          	ld	a,(OFST+0,sp)
 792  0131 4c            	inc	a
 793  0132 95            	ld	xh,a
 794  0133 cd0000        	call	L3_display_num
 796                     ; 118     display_num(base + 2, num2 % 10);
 798  0136 7b06          	ld	a,(OFST+5,sp)
 799  0138 ae000a        	ldw	x,#10
 800  013b 51            	exgw	x,y
 801  013c 5f            	clrw	x
 802  013d 97            	ld	xl,a
 803  013e 65            	divw	x,y
 804  013f 909f          	ld	a,yl
 805  0141 97            	ld	xl,a
 806  0142 7b01          	ld	a,(OFST+0,sp)
 807  0144 ab02          	add	a,#2
 808  0146 95            	ld	xh,a
 809  0147 cd0000        	call	L3_display_num
 811                     ; 119 }
 812  014a               L44:
 815  014a 5b03          	addw	sp,#3
 816  014c 81            	ret
 871                     ; 121 static void display_date(uint8_t month, uint8_t day, bool on)
 871                     ; 122 {
 872                     	switch	.text
 873  014d               L742_display_date:
 875  014d 89            	pushw	x
 876       00000000      OFST:	set	0
 879                     ; 123     display_char(MonthDate, on);
 881  014e 7b05          	ld	a,(OFST+5,sp)
 882  0150 97            	ld	xl,a
 883  0151 4f            	clr	a
 884  0152 95            	ld	xh,a
 885  0153 cd0068        	call	L76_display_char
 887                     ; 124     display_time(Date, month, day, on);
 889  0156 7b05          	ld	a,(OFST+5,sp)
 890  0158 88            	push	a
 891  0159 7b03          	ld	a,(OFST+3,sp)
 892  015b 88            	push	a
 893  015c 7b03          	ld	a,(OFST+3,sp)
 894  015e 97            	ld	xl,a
 895  015f 4f            	clr	a
 896  0160 95            	ld	xh,a
 897  0161 cd00af        	call	L502_display_time
 899  0164 85            	popw	x
 900                     ; 125 }
 903  0165 85            	popw	x
 904  0166 81            	ret
 959                     ; 127 static void display_clock(uint8_t hour, uint8_t minute, bool on)
 959                     ; 128 {
 960                     	switch	.text
 961  0167               L772_display_clock:
 963  0167 89            	pushw	x
 964       00000000      OFST:	set	0
 967                     ; 129     display_char(Colon, on);
 969  0168 7b05          	ld	a,(OFST+5,sp)
 970  016a 97            	ld	xl,a
 971  016b a601          	ld	a,#1
 972  016d 95            	ld	xh,a
 973  016e cd0068        	call	L76_display_char
 975                     ; 130     display_time(Clock, hour, minute, on);
 977  0171 7b05          	ld	a,(OFST+5,sp)
 978  0173 88            	push	a
 979  0174 7b03          	ld	a,(OFST+3,sp)
 980  0176 88            	push	a
 981  0177 7b03          	ld	a,(OFST+3,sp)
 982  0179 97            	ld	xl,a
 983  017a a601          	ld	a,#1
 984  017c 95            	ld	xh,a
 985  017d cd00af        	call	L502_display_time
 987  0180 85            	popw	x
 988                     ; 131 }
 991  0181 85            	popw	x
 992  0182 81            	ret
1038                     ; 133 static void display_am_pm(bool pm, bool on)
1038                     ; 134 {
1039                     	switch	.text
1040  0183               L723_display_am_pm:
1042  0183 89            	pushw	x
1043       00000000      OFST:	set	0
1046                     ; 135     display_char(AM, on && !pm);
1048  0184 9f            	ld	a,xl
1049  0185 4d            	tnz	a
1050  0186 2708          	jreq	L45
1051  0188 9e            	ld	a,xh
1052  0189 4d            	tnz	a
1053  018a 2604          	jrne	L45
1054  018c a601          	ld	a,#1
1055  018e 2001          	jra	L65
1056  0190               L45:
1057  0190 4f            	clr	a
1058  0191               L65:
1059  0191 97            	ld	xl,a
1060  0192 a603          	ld	a,#3
1061  0194 95            	ld	xh,a
1062  0195 cd0068        	call	L76_display_char
1064                     ; 136     display_char(PM, on && pm);
1066  0198 0d02          	tnz	(OFST+2,sp)
1067  019a 2708          	jreq	L06
1068  019c 0d01          	tnz	(OFST+1,sp)
1069  019e 2704          	jreq	L06
1070  01a0 a601          	ld	a,#1
1071  01a2 2001          	jra	L26
1072  01a4               L06:
1073  01a4 4f            	clr	a
1074  01a5               L26:
1075  01a5 97            	ld	xl,a
1076  01a6 a604          	ld	a,#4
1077  01a8 95            	ld	xh,a
1078  01a9 cd0068        	call	L76_display_char
1080                     ; 137 }
1083  01ac 85            	popw	x
1084  01ad 81            	ret
1114                     ; 164 static void lcd_glass_init(void)
1114                     ; 165 {
1115                     	switch	.text
1116  01ae               L353_lcd_glass_init:
1120                     ; 167     CLK_PeripheralClockConfig(CLK_Peripheral_LCD, ENABLE);
1122  01ae ae0001        	ldw	x,#1
1123  01b1 a613          	ld	a,#19
1124  01b3 95            	ld	xh,a
1125  01b4 cd0000        	call	_CLK_PeripheralClockConfig
1127                     ; 170     LCD_Init(LCD_Prescaler_4, LCD_Divider_18, LCD_Duty_1_4,
1127                     ; 171            LCD_Bias_1_3, LCD_VoltageSource_External);
1129  01b7 4b01          	push	#1
1130  01b9 4b00          	push	#0
1131  01bb 4b06          	push	#6
1132  01bd ae0002        	ldw	x,#2
1133  01c0 a620          	ld	a,#32
1134  01c2 95            	ld	xh,a
1135  01c3 cd0000        	call	_LCD_Init
1137  01c6 5b03          	addw	sp,#3
1138                     ; 174     LCD_PortMaskConfig(LCD_PortMaskRegister_0, 0xFE); // 1~7
1140  01c8 ae00fe        	ldw	x,#254
1141  01cb 4f            	clr	a
1142  01cc 95            	ld	xh,a
1143  01cd cd0000        	call	_LCD_PortMaskConfig
1145                     ; 175     LCD_PortMaskConfig(LCD_PortMaskRegister_1, 0xFC); // 10~15
1147  01d0 ae00fc        	ldw	x,#252
1148  01d3 a601          	ld	a,#1
1149  01d5 95            	ld	xh,a
1150  01d6 cd0000        	call	_LCD_PortMaskConfig
1152                     ; 176     LCD_PortMaskConfig(LCD_PortMaskRegister_2, 0xB9); // 16 19~21 23
1154  01d9 ae00b9        	ldw	x,#185
1155  01dc a602          	ld	a,#2
1156  01de 95            	ld	xh,a
1157  01df cd0000        	call	_LCD_PortMaskConfig
1159                     ; 177     LCD_PortMaskConfig(LCD_PortMaskRegister_3, 0x89); // 24 27 31
1161  01e2 ae0089        	ldw	x,#137
1162  01e5 a603          	ld	a,#3
1163  01e7 95            	ld	xh,a
1164  01e8 cd0000        	call	_LCD_PortMaskConfig
1166                     ; 178     LCD_PortMaskConfig(LCD_PortMaskRegister_4, 0x0F); // 32~35
1168  01eb ae000f        	ldw	x,#15
1169  01ee a604          	ld	a,#4
1170  01f0 95            	ld	xh,a
1171  01f1 cd0000        	call	_LCD_PortMaskConfig
1173                     ; 179     LCD_PortMaskConfig(LCD_PortMaskRegister_5, 0x00);
1175  01f4 5f            	clrw	x
1176  01f5 a605          	ld	a,#5
1177  01f7 95            	ld	xh,a
1178  01f8 cd0000        	call	_LCD_PortMaskConfig
1180                     ; 181     LCD_ContrastConfig(LCD_Contrast_Level_7);
1182  01fb a60e          	ld	a,#14
1183  01fd cd0000        	call	_LCD_ContrastConfig
1185                     ; 182     LCD_DeadTimeConfig(LCD_DeadTime_0);
1187  0200 4f            	clr	a
1188  0201 cd0000        	call	_LCD_DeadTimeConfig
1190                     ; 183     LCD_PulseOnDurationConfig(LCD_PulseOnDuration_7);
1192  0204 a6e0          	ld	a,#224
1193  0206 cd0000        	call	_LCD_PulseOnDurationConfig
1195                     ; 185     LCD_Cmd(ENABLE); /*!< Enable LCD peripheral */
1197  0209 a601          	ld	a,#1
1198  020b cd0000        	call	_LCD_Cmd
1200                     ; 186 }
1203  020e 81            	ret
1206                     	bsct
1207  0000               _pt_display_queue:
1208  0000 0000          	dc.w	0
1415                     ; 196 void display_thread(uint32_t param)
1415                     ; 197 {
1416                     	switch	.text
1417  020f               _display_thread:
1419  020f 5209          	subw	sp,#9
1420       00000009      OFST:	set	9
1423                     ; 199     int32_t cnt = 0;
1425  0211 ae0000        	ldw	x,#0
1426  0214 1f03          	ldw	(OFST-6,sp),x
1427  0216 ae0000        	ldw	x,#0
1428  0219 1f01          	ldw	(OFST-8,sp),x
1429                     ; 202     lcd_glass_init();
1431  021b ad91          	call	L353_lcd_glass_init
1433                     ; 204     status = atomQueueCreate(&display_queue, (uint8_t *)display_queue_storage,
1433                     ; 205                 sizeof(display_queue_storage[0]), DISPLAY_QUEUE_ENTRIES);
1435  021d ae0004        	ldw	x,#4
1436  0220 89            	pushw	x
1437  0221 ae0000        	ldw	x,#0
1438  0224 89            	pushw	x
1439  0225 ae0004        	ldw	x,#4
1440  0228 89            	pushw	x
1441  0229 ae0000        	ldw	x,#0
1442  022c 89            	pushw	x
1443  022d ae0000        	ldw	x,#L763_display_queue_storage
1444  0230 89            	pushw	x
1445  0231 ae0010        	ldw	x,#L563_display_queue
1446  0234 cd0000        	call	_atomQueueCreate
1448  0237 5b0a          	addw	sp,#10
1449  0239 6b05          	ld	(OFST-4,sp),a
1450                     ; 206     if (status != ATOM_OK) {
1452  023b 0d05          	tnz	(OFST-4,sp)
1453  023d 2709          	jreq	L715
1454                     ; 207         printf("atomQueueCreate display_queue failed!\n");
1456  023f ae0081        	ldw	x,#L125
1457  0242 cd0000        	call	_printf
1459                     ; 208         return;
1462  0245 5b09          	addw	sp,#9
1463  0247 81            	ret
1464  0248               L715:
1465                     ; 211     pt_display_queue = (void *)&display_queue;
1467  0248 ae0010        	ldw	x,#L563_display_queue
1468  024b bf00          	ldw	_pt_display_queue,x
1469  024d               L325:
1470                     ; 214         status = atomQueueGet(pt_display_queue, 0, (uint8_t *)&msg);
1472  024d 96            	ldw	x,sp
1473  024e 1c0006        	addw	x,#OFST-3
1474  0251 89            	pushw	x
1475  0252 ae0000        	ldw	x,#0
1476  0255 89            	pushw	x
1477  0256 ae0000        	ldw	x,#0
1478  0259 89            	pushw	x
1479  025a be00          	ldw	x,_pt_display_queue
1480  025c cd0000        	call	_atomQueueGet
1482  025f 5b06          	addw	sp,#6
1483  0261 6b05          	ld	(OFST-4,sp),a
1484                     ; 215         if (status != ATOM_OK) {
1486  0263 0d05          	tnz	(OFST-4,sp)
1487  0265 26e6          	jrne	L325
1488                     ; 216             continue;
1490                     ; 219         switch (msg.type)
1492  0267 7b06          	ld	a,(OFST-3,sp)
1494                     ; 228         default:
1494                     ; 229             break;
1495  0269 4d            	tnz	a
1496  026a 2705          	jreq	L173
1497  026c 4a            	dec	a
1498  026d 2710          	jreq	L373
1499  026f 20dc          	jra	L325
1500  0271               L173:
1501                     ; 221         case DISPLAY_DATE:
1501                     ; 222             display_date(msg.u.date.month, msg.u.date.day, TRUE);
1503  0271 4b01          	push	#1
1504  0273 7b09          	ld	a,(OFST+0,sp)
1505  0275 97            	ld	xl,a
1506  0276 7b08          	ld	a,(OFST-1,sp)
1507  0278 95            	ld	xh,a
1508  0279 cd014d        	call	L742_display_date
1510  027c 84            	pop	a
1511                     ; 223             break;
1513  027d 20ce          	jra	L325
1514  027f               L373:
1515                     ; 224         case DISPLAY_CLOCK:
1515                     ; 225             display_clock(msg.u.clock.hour, msg.u.clock.minute, TRUE);
1517  027f 4b01          	push	#1
1518  0281 7b09          	ld	a,(OFST+0,sp)
1519  0283 97            	ld	xl,a
1520  0284 7b08          	ld	a,(OFST-1,sp)
1521  0286 95            	ld	xh,a
1522  0287 cd0167        	call	L772_display_clock
1524  028a 84            	pop	a
1525                     ; 226             display_am_pm(msg.u.clock.pm, TRUE);
1527  028b ae0001        	ldw	x,#1
1528  028e 7b09          	ld	a,(OFST+0,sp)
1529  0290 95            	ld	xh,a
1530  0291 cd0183        	call	L723_display_am_pm
1532                     ; 227             break;
1534  0294 20b7          	jra	L325
1535  0296               L573:
1536                     ; 228         default:
1536                     ; 229             break;
1538  0296 20b5          	jra	L325
1539  0298               L335:
1541  0298 20b3          	jra	L325
1836                     	switch	.ubsct
1837  0000               L763_display_queue_storage:
1838  0000 000000000000  	ds.b	16
1839  0010               L563_display_queue:
1840  0010 000000000000  	ds.b	26
1841                     	xdef	_SEG8
1842                     	xdef	_LCD_CHAR_BIT
1843                     	xdef	_LCD_NUM_BIT
1844                     	xdef	_display_thread
1845                     	xdef	_pt_display_queue
1846                     	xref	_atomQueueGet
1847                     	xref	_atomQueueCreate
1848                     	xref	_LCD_ContrastConfig
1849                     	xref	_LCD_DeadTimeConfig
1850                     	xref	_LCD_PulseOnDurationConfig
1851                     	xref	_LCD_Cmd
1852                     	xref	_LCD_PortMaskConfig
1853                     	xref	_LCD_Init
1854                     	xref	_CLK_PeripheralClockConfig
1855                     	xref	_printf
1856                     	switch	.const
1857  0081               L125:
1858  0081 61746f6d5175  	dc.b	"atomQueueCreate di"
1859  0093 73706c61795f  	dc.b	"splay_queue failed"
1860  00a5 210a00        	dc.b	"!",10,0
1861                     	xref.b	c_x
1881                     	xref	c_sdivx
1882                     	end
